<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>My Dashboard - ActivWork Training Portal</title>
</head>
<body>
<div layout:fragment="content">
    <!-- Welcome Section -->
    <div class="mb-8">
        <h1 class="text-4xl font-bold text-text-primary dark:text-text-light mb-2">
            Welcome back, <span th:text="${user.name}">Candidate</span>!
        </h1>
        <p class="text-text-secondary dark:text-text-muted">
            Continue developing your IT skills for career success
        </p>
    </div>
    
    <!-- Quick Stats -->
    <div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <!-- Active Enrollments -->
        <div class="bg-bg-secondary dark:bg-bg-darkSecondary rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-text-secondary dark:text-text-muted text-sm mb-1">Active Courses</p>
                    <h3 class="text-3xl font-bold text-text-primary dark:text-text-light" 
                        th:text="${#lists.size(activeEnrollments)}">3</h3>
                </div>
                <div class="bg-primary-100 dark:bg-primary-900 rounded-full p-4">
                    <i class="fas fa-book-reader text-2xl text-primary-600 dark:text-primary-400"></i>
                </div>
            </div>
        </div>
        
        <!-- Total Enrollments -->
        <div class="bg-bg-secondary dark:bg-bg-darkSecondary rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-text-secondary dark:text-text-muted text-sm mb-1">Total Courses</p>
                    <h3 class="text-3xl font-bold text-text-primary dark:text-text-light" th:text="${totalEnrollments}">5</h3>
                </div>
                <div class="bg-green-100 dark:bg-green-900 rounded-full p-4">
                    <i class="fas fa-graduation-cap text-2xl text-green-600 dark:text-green-400"></i>
                </div>
            </div>
        </div>
        
        <!-- Completed Courses -->
        <div class="bg-bg-secondary dark:bg-bg-darkSecondary rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-text-secondary dark:text-text-muted text-sm mb-1">Completed</p>
                    <h3 class="text-3xl font-bold text-text-primary dark:text-text-light">
                        <span th:text="${completedCount}">1</span>
                    </h3>
                </div>
                <div class="bg-blue-100 dark:bg-blue-900 rounded-full p-4">
                    <i class="fas fa-certificate text-2xl text-blue-600 dark:text-blue-400"></i>
                </div>
            </div>
        </div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div>
        <div class="bg-gradient-to-r from-primary-600 to-primary-800 dark:from-primary-700 dark:to-primary-900 rounded-lg shadow-xl p-8 mb-8 text-white">
        <h2 class="text-2xl font-bold mb-6">
            <i class="fas fa-bolt mr-2"></i>Quick Actions
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <a th:href="@{/courses}" 
               class="bg-white/10 hover:bg-white/20 rounded-lg p-6 text-center transition backdrop-blur-sm">
                <i class="fas fa-search text-4xl mb-3"></i>
                <p class="font-semibold">Browse Courses</p>
            </a>
            
            <a th:href="@{/learner/enrollments}" 
               class="bg-white/10 hover:bg-white/20 rounded-lg p-6 text-center transition backdrop-blur-sm">
                <i class="fas fa-book-open text-4xl mb-3"></i>
                <p class="font-semibold">My Enrollments</p>
            </a>
            
            <a href="#active-courses" 
               class="bg-white/10 hover:bg-white/20 rounded-lg p-6 text-center transition backdrop-blur-sm">
                <i class="fas fa-chart-line text-4xl mb-3"></i>
                <p class="font-semibold">View Progress</p>
            </a>
        </div>
        </div>
    </div>
    
    <!-- Active Courses -->
    <div id="active-courses" class="mb-8">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-text-primary dark:text-text-light">
                <i class="fas fa-book-reader mr-2"></i>Continue Learning
            </h2>
            <a th:href="@{/learner/enrollments}" 
               class="text-primary-600 dark:text-primary-400 hover:underline font-semibold">
                View All <i class="fas fa-arrow-right ml-1"></i>
            </a>
        </div>
        
        <!-- Enrollment Cards -->
        <div th:if="${activeEnrollments != null and !activeEnrollments.empty}" 
             class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div th:each="enrollment : ${activeEnrollments}" 
                 class="bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition overflow-hidden">
                <!-- Course Thumbnail -->
                <div class="h-48 bg-gradient-to-r from-primary-500 to-primary-700 flex items-center justify-center relative">
                    <i th:if="${enrollment.courseThumbnailUrl == null}" 
                       class="fas fa-book text-white text-6xl"></i>
                    <img th:if="${enrollment.courseThumbnailUrl != null}" 
                         th:src="${enrollment.courseThumbnailUrl}" 
                         th:alt="${enrollment.courseTitle}"
                         class="w-full h-full object-cover">
                    
                    <!-- Status Badge -->
                    <div class="absolute top-4 right-4">
                        <span th:class="${enrollment.status.name() == 'ACTIVE' ? 'bg-green-500' : 
                                         enrollment.status.name() == 'COMPLETED' ? 'bg-blue-500' : 'bg-gray-500'} + ' px-4 py-2 text-white text-sm font-semibold rounded-full'"
                              th:text="${enrollment.status}">ACTIVE</span>
                    </div>
                </div>
                
                <!-- Course Content -->
                <div class="p-6">
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4 line-clamp-2">
                        <a th:href="@{/learner/enrollments/{id}(id=${enrollment.id})}" 
                           th:text="${enrollment.courseTitle}"
                           class="hover:text-primary-600 dark:hover:text-primary-400">
                            Java Spring Boot Fundamentals
                        </a>
                    </h3>
                    
                    <!-- Progress Bar -->
                    <div class="mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Progress</span>
                            <span class="text-sm font-bold text-primary-600 dark:text-primary-400" 
                                  th:text="${enrollment.progressPercent != null ? #numbers.formatDecimal(enrollment.progressPercent, 1, 0) + '%' : '0%'}">
                                75%
                            </span>
                        </div>
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3">
                            <div class="bg-primary-600 dark:bg-primary-500 h-3 rounded-full progress-bar-fill" 
                                 th:style="'width: ' + ${enrollment.progressPercent ?: 0} + '%'"></div>
                        </div>
                    </div>
                    
                    <!-- Enrollment Meta -->
                    <div class="grid grid-cols-2 gap-4 mb-4 text-sm text-gray-600 dark:text-gray-400">
                        <div>
                            <i class="fas fa-calendar mr-1"></i>
                            Enrolled: <span th:text="${#temporals.format(enrollment.enrolledAt, 'MMM dd')}">Oct 10</span>
                        </div>
                        <div th:if="${enrollment.lastAccessed != null}">
                            <i class="fas fa-clock mr-1"></i>
                            Last: <span th:text="${#temporals.format(enrollment.lastAccessed, 'MMM dd')}">Oct 12</span>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="flex gap-2">
                        <a th:href="@{/learner/enrollments/{id}(id=${enrollment.id})}" 
                           class="flex-1 py-2 px-4 bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600 text-white text-center font-semibold rounded-lg transition">
                            <i class="fas fa-play mr-1"></i>Continue
                        </a>
                        
                        <a th:href="@{/learner/courses/{id}/feedback(id=${enrollment.courseId})}" 
                           class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded-lg transition">
                            <i class="fas fa-star"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Empty State -->
        <div th:if="${activeEnrollments == null or activeEnrollments.empty}" 
             class="text-center py-12 bg-white dark:bg-gray-800 rounded-lg shadow-md">
            <i class="fas fa-inbox text-6xl text-gray-400 mb-4"></i>
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">No Active Courses</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-6">
                Start building your skills by enrolling in a training course
            </p>
            <a th:href="@{/courses}" 
               class="inline-block px-6 py-3 bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600 text-white font-semibold rounded-lg transition">
                <i class="fas fa-search mr-2"></i>Browse Courses
            </a>
        </div>
    </div>
</div>
</body>
</html>

